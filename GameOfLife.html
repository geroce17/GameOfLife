<!DOCTYPE html>
<html lang="es-MX">

<head>
    <meta charset="UFT-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0,maximum-scale=1.0, minimum-scale=.1">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
<div class="container">
    <input id="txtSize" type="text">
    <input type="button" value="Genera una tabla" onclick="genera_tabla()">
    <input type="button" value="inicio" onclick="hazMagia()">
    <label id="ex">----------------</label>
    <section id="tablero">
        <!--Aqui va el codigo generado-->
    </section>
</div>

<script>
    //Declaracion global de matriz
    var matriz = new Array(3);
    // Obtiene el tama√±o deseado para el tablero (no mas de 150 aprx)
    var size;
    
    function genera_tabla() {
      // Obtener la referencia del elemento body
      document.getElementById("tablero").innerHTML="";
      var body = document.getElementsByTagName("section")[0];

      // Crea un elemento <table> y un elemento <tbody>
      var tabla   = document.createElement("table");
      var tblBody = document.createElement("tbody");
        
      size = document.getElementById("txtSize").value;
      // Crea las celdas
      for (var i = 0; i < size; i++) {
          matriz[i]=new Array(3);
        // Crea las hileras de la tabla
        var hilera = document.createElement("tr");

        for (var j = 0; j < size; j++) {
          // Crea un elemento <td> y un nodo de texto, haz que el nodo de
          // texto sea el contenido de <td>, ubica el elemento <td> al final
          // de la hilera de la tabla
          var celda = document.createElement("td");
            celda.onclick = function() {cambiaColor(this)};
            celda.style.backgroundColor = "black";
            celda.style.padding = "3px";
            matriz[i][j]=celda;
          //var textoCelda = document.createTextNode("H "+i+", C "+j);
          //celda.appendChild(textoCelda);
          hilera.appendChild(celda);
        }

        // agrega la hilera al final de la tabla (al final del elemento tblbody)
        tblBody.appendChild(hilera);
      }

      // posiciona el <tbody> debajo del elemento <table>
      tabla.appendChild(tblBody);
      // appends <table> into <body>
      body.appendChild(tabla);
      // modifica el atributo "border" de la tabla y lo fija a "2";
      tabla.setAttribute("border", ".1");
    }
    
    function colorC(r,c){
        matriz[r][c].style.backgroundColor="white";
    }

function hazMagia()
{
    document.getElementById("ex").textContent=size;
    var el, up, down, right, left, dls, dli, drs,dri, val, antEL, antVal, cont;
    
    for(var r = 1; r < size-1; r++)
    {
        for(var c = 1; c < size-1; c++)
        {
            
            val=false;
            cont=0;
            el=matriz[r][c];
            if(el.style.backgroundColor=="black")
            {
                up=matriz[r-1][c];
                down=matriz[r+1][c];
                right=matriz[r][c+1];
                left=matriz[r][c-1];
                dls=matriz[r-1][c-1];
                dli=matriz[r+1][c-1];
                drs=matriz[r-1][c+1];
                dri=matriz[r+1][c+1];

                if(up!=undefined && up.style.backgroundColor=="white")
                    cont++;
                if(down!=undefined && down.style.backgroundColor=="white")
                    cont++;
                if(left!=undefined && left.style.backgroundColor=="white")
                    cont++;
                if(right!=undefined && right.style.backgroundColor=="white")
                    cont++;
                if(dls!=undefined && dls.style.backgroundColor=="white")
                    cont++;
                if(dli!=undefined && dli.style.backgroundColor=="white")
                    cont++;
                if(drs!=undefined && drs.style.backgroundColor=="white")
                    cont++;
                if(dri!=undefined && dri.style.backgroundColor=="white")
                    cont++;

                if(cont==3){
                    val=true;
                }
                
                if(antVal!=undefined && antVal==true)
                        antEL.style.backgroundColor="white";

                if(val==true)
                {
                    antVal=val;
                    antEL=el;
                }
                /*if(el.style.backgroundColor=="white"){
                    if(cont<2 || cont>3)
                        el.style.backgroundColor="black";
                }*/
            }
        }
    }
    
    /*for(var r = 1; r < size-1; r++)
    {
        for(var c = 1; c < size-1; c++)
        {
            val=false;
            cont=0;
            el=matriz[r][c];
            if(el.style.backgroundColor=="white")
            {
                up=matriz[r-1][c];
                down=matriz[r+1][c];
                right=matriz[r][c+1];
                left=matriz[r][c-1];
                dlu=matriz[r+1][c-1];
                dld=matriz[r-1][c-1];
                dru=matriz[r+1][c+1];
                drd=matriz[r-1][c+1];

                if(up!=undefined && up.style.backgroundColor=="white")
                    cont++; vector.push(cont);
                if(down!=undefined && down.style.backgroundColor=="white")
                    cont++;vector.push(cont);
                if(left!=undefined && left.style.backgroundColor=="white")
                    cont++;vector.push(cont);
                if(right!=undefined && right.style.backgroundColor=="white")
                    cont++;vector.push(cont);
                if(dlu!=undefined && dlu.style.backgroundColor=="white")
                    cont++;vector.push(cont);
                if(dld!=undefined && dld.style.backgroundColor=="white")
                    cont++;vector.push(cont);
                if(dru!=undefined && dru.style.backgroundColor=="white")
                    cont++;vector.push(cont);
                if(drd!=undefined && drd.style.backgroundColor=="white")
                    cont++;vector.push(cont);

                if(el.style.backgroundColor=="white"){
                    if(cont<2 || cont>3)
                        el.style.backgroundColor="black";
                }
            }
        }
    }*/
}
    
/*function contadorVecinos(){
    cont = 0;
    if(up!=undefined && up.style.backgroundColor=="white")
        cont++; vector.push(cont);
    if(down!=undefined && down.style.backgroundColor=="white")
        cont++;vector.push(cont);
    if(left!=undefined && left.style.backgroundColor=="white")
        cont++;vector.push(cont);
    if(right!=undefined && right.style.backgroundColor=="white")
        cont++;vector.push(cont);
    if(dlu!=undefined && dlu.style.backgroundColor=="white")
        cont++;vector.push(cont);
    if(dld!=undefined && dld.style.backgroundColor=="white")
        cont++;vector.push(cont);
    if(dru!=undefined && dru.style.backgroundColor=="white")
        cont++;vector.push(cont);
    if(drd!=undefined && drd.style.backgroundColor=="white")
        cont++;vector.push(cont);
}*/

function cambiaColor(celda)
{
    if(celda.style.backgroundColor=="black"){
        celda.style.backgroundColor="white";
    }
    else
        celda.style.backgroundColor="black";
}
</script>

<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>

</body>
</html>
